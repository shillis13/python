<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infographic: The Living Instructions Protocol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 320px;
            max-height: 40vh;
            width: 100%;
            max-width: 600px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
                max-height: 50vh;
            }
        }
        .flow-arrow::after {
            content: '‚ñº';
            font-size: 2rem;
            color: #00B9AE;
            line-height: 1;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #00B9AE;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center my-12">
            <h1 class="text-4xl md:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-[#00F5D4] to-[#00B9AE]">The Living Instructions Protocol</h1>
            <p class="mt-4 text-lg md:text-xl text-gray-300 max-w-3xl mx-auto">A system for creating persistent, evolving, and collaborative AI agents.</p>
        </header>

        <main>
            <section id="challenge" class="my-16">
                <h2 class="text-3xl font-bold text-center mb-8 flex items-center justify-center">The Challenge: Static AI Interactions <button onclick="explainSection('challenge')" class="text-2xl ml-3 text-[#00F5D4] hover:text-white transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-center">
                    <div class="bg-gray-800 rounded-lg shadow-2xl p-8 transform hover:scale-105 transition-transform duration-300">
                        <div class="text-6xl mb-4">üß†‚û°Ô∏èüóëÔ∏è</div>
                        <h3 class="text-2xl font-bold text-[#00F5D4] mb-2">Stateless Sessions</h3>
                        <p class="text-gray-400">Standard AI conversations are ephemeral. Once the session ends, all context, learned nuances, and specific instructions are lost, requiring the user to start from scratch every time.</p>
                    </div>
                    <div class="bg-gray-800 rounded-lg shadow-2xl p-8 transform hover:scale-105 transition-transform duration-300">
                        <div class="text-6xl mb-4">üìúüö´‚úçÔ∏è</div>
                        <h3 class="text-2xl font-bold text-[#00F5D4] mb-2">Fixed Instructions</h3>
                        <p class="text-gray-400">The AI's core instructions are typically set once and cannot be modified or improved through interaction, limiting the agent's ability to adapt to the user's evolving needs.</p>
                    </div>
                </div>
            </section>

            <section id="philosophy" class="my-24">
                <h2 class="text-3xl font-bold text-center mb-12 flex items-center justify-center">Core Design Philosophy <button onclick="explainSection('philosophy')" class="text-2xl ml-3 text-[#00F5D4] hover:text-white transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 text-center">
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <div class="text-4xl mb-3">ü§ù</div><h3 class="text-lg font-bold text-[#00F5D4]">Collaborative Evolution</h3><p class="text-sm text-gray-400 mt-2">Instructions evolve through user-AI agreement.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <div class="text-4xl mb-3">‚öôÔ∏è</div><h3 class="text-lg font-bold text-[#00F5D4]">Programmatic Robustness</h3><p class="text-sm text-gray-400 mt-2">A trusted script toolchain handles all modifications.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <div class="text-4xl mb-3">‚úÖ</div><h3 class="text-lg font-bold text-[#00F5D4]">Structured & Validated</h3><p class="text-sm text-gray-400 mt-2">YAML data is validated against a formal schema.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <div class="text-4xl mb-3">üìú</div><h3 class="text-lg font-bold text-[#00F5D4]">Self-Contained History</h3><p class="text-sm text-gray-400 mt-2">An audit trail is built directly into the instruction file.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <div class="text-4xl mb-3">üßë‚Äç‚öñÔ∏è</div><h3 class="text-lg font-bold text-[#00F5D4]">Human as Final Authority</h3><p class="text-sm text-gray-400 mt-2">The user performs the final "commit" of all changes.</p>
                    </div>
                </div>
            </section>

            <section id="architecture" class="my-24">
                <h2 class="text-3xl font-bold text-center mb-12 flex items-center justify-center">System Architecture <button onclick="explainSection('architecture')" class="text-2xl ml-3 text-[#00F5D4] hover:text-white transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                    <div class="bg-gray-800 p-6 rounded-lg shadow-2xl">
                        <h3 class="text-xl font-bold text-center mb-4 text-[#00F5D4]">Component Distribution</h3>
                        <div class="chart-container">
                            <canvas id="componentDonutChart"></canvas>
                        </div>
                        <p class="text-center mt-4 text-gray-400">The system is primarily composed of the Python script toolchain that provides functionality, supported by YAML data files and a suite of automated tests.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-2xl">
                        <h3 class="text-xl font-bold text-center mb-4 text-[#00F5D4]">Toolchain Responsibilities</h3>
                        <div class="chart-container">
                            <canvas id="scriptBarChart"></canvas>
                        </div>
                         <p class="text-center mt-4 text-gray-400">The toolchain provides distinct scripts for every atomic operation, from validation and reading to complex actions like merging and pruning historical data.</p>
                    </div>
                </div>
            </section>

            <section id="workflow" class="my-24">
                <h2 class="text-3xl font-bold text-center mb-12 flex items-center justify-center">The Workflow in Action <button onclick="explainSection('workflow')" class="text-2xl ml-3 text-[#00F5D4] hover:text-white transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <p class="text-center max-w-3xl mx-auto mb-12 text-gray-300">The protocol creates a continuous improvement loop. The cycle begins with reading the master instructions and ends with the user committing an improved version for the next session.</p>
                <div class="flex flex-col items-center space-y-4">
                    
                    <div class="border-2 border-[#00B9AE] bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-[#00F5D4]">Step 1: AI Action</div>
                        <h4 class="text-xl font-bold mt-1">Session Start</h4>
                        <p class="text-gray-400 mt-2">AI reads `master_instructions.yaml` and creates an editable in-session copy.</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div class="border-2 border-dashed border-gray-600 bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-gray-400">Step 2: Collaborative Session</div>
                        <h4 class="text-xl font-bold mt-1">User & AI Interaction</h4>
                        <p class="text-gray-400 mt-2">User and AI discuss and agree upon a change to the instructions.</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div class="border-2 border-[#00B9AE] bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-[#00F5D4]">Step 3: AI Action</div>
                        <h4 class="text-xl font-bold mt-1">Programmatic Update</h4>
                        <p class="text-gray-400 mt-2">AI calls the relevant script (e.g., `update_key.py`) to modify the in-session copy, archiving the previous state.</p>
                    </div>
                    <div class="flow-arrow"></div>
                     <div class="border-2 border-[#007369] bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-[#00B9AE]">Step 4: User Request</div>
                        <h4 class="text-xl font-bold mt-1">Session Conclusion</h4>
                        <p class="text-gray-400 mt-2">User asks the AI to prepare the finalized instructions for saving.</p>
                    </div>
                     <div class="flow-arrow"></div>
                    <div class="border-2 border-[#00B9AE] bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-[#00F5D4]">Step 5: AI Action</div>
                        <h4 class="text-xl font-bold mt-1">Export Instructions</h4>
                        <p class="text-gray-400 mt-2">AI presents the final YAML content in a clean, copyable code block.</p>
                    </div>
                     <div class="flow-arrow"></div>
                    <div class="border-2 border-[#007369] bg-gray-800 rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-[#00B9AE]">Step 6: User "Commit"</div>
                        <h4 class="text-xl font-bold mt-1">Save New Master</h4>
                        <p class="text-gray-400 mt-2">User saves the exported content as the new `master_instructions.yaml`, making it the source of truth for the next session.</p>
                    </div>

                </div>
            </section>
            
            <section id="sandbox" class="my-24 bg-gray-800 p-8 rounded-lg shadow-2xl">
                 <h2 class="text-3xl font-bold text-center mb-2">Interactive Sandbox</h2>
                 <p class="text-center text-gray-400 mb-8">Test the protocol by generating a sample instruction file for any AI persona.</p>
                 <div class="max-w-4xl mx-auto">
                    <div class="flex flex-col sm:flex-row gap-4 mb-6">
                        <input type="text" id="personaInput" placeholder="Enter an AI persona (e.g., 'A helpful sous-chef')" class="flex-grow bg-gray-700 border border-gray-600 rounded-md p-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#00F5D4]">
                        <button id="generateBtn" onclick="generateInstructions()" class="bg-gradient-to-r from-[#00F5D4] to-[#00B9AE] text-gray-900 font-bold py-3 px-6 rounded-md hover:opacity-90 transition-opacity duration-300 flex items-center justify-center space-x-2">
                            <span>Generate Instructions</span>
                            <span class="text-xl">‚ú®</span>
                        </button>
                    </div>
                    <div id="loader" class="hidden mx-auto my-8 loader"></div>
                    <div id="outputContainer" class="hidden">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-lg font-semibold text-gray-300">Generated `master_instructions.yaml`</h4>
                            <button onclick="copyToClipboard()" class="bg-gray-700 text-sm py-1 px-3 rounded-md hover:bg-gray-600">Copy</button>
                        </div>
                        <pre class="bg-gray-900 rounded-md p-4 max-h-[400px] overflow-auto"><code id="yamlOutput" class="language-yaml"></code></pre>
                    </div>
                 </div>
            </section>

            <section id="advanced" class="my-24">
                 <h2 class="text-3xl font-bold text-center mb-8 flex items-center justify-center">Advanced Capabilities <button onclick="explainSection('advanced')" class="text-2xl ml-3 text-[#00F5D4] hover:text-white transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-center">
                    <div class="bg-gray-800 rounded-lg shadow-2xl p-8">
                        <div class="text-6xl mb-4">‚ûø</div>
                        <h3 class="text-2xl font-bold text-[#00F5D4] mb-2">Merge Divergent Histories</h3>
                        <p class="text-gray-400">When instructions are changed across multiple chat sessions, the `merge.py` script helps the user intelligently combine them by identifying conflicts and merging non-conflicting updates.</p>
                    </div>
                    <div class="bg-gray-800 rounded-lg shadow-2xl p-8">
                        <div class="text-6xl mb-4">üåø</div>
                        <h3 class="text-2xl font-bold text-[#00F5D4] mb-2">Prune Instruction History</h3>
                        <p class="text-gray-400">To manage file size, the `prune.py` script can be used to trim the built-in audit trail, keeping only the most recent N versions of any changed section, ensuring long-term maintainability.</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-16 pb-8">
            <p class="text-gray-500">A robust framework for building adaptive and intelligent AI agents.</p>
        </footer>

    </div>
    
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-gray-800 rounded-lg shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b border-gray-700">
                <h3 id="modalTitle" class="text-xl font-bold text-[#00F5D4]">Explanation</h3>
                <button onclick="closeModal()" class="text-2xl text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="modalContent" class="p-6 overflow-y-auto">
                <div class="loader mx-auto"></div>
            </div>
        </div>
    </div>


    <script>
        const colorPalette = {
            primary: '#00F5D4',
            secondary: '#00B9AE',
            tertiary: '#007369',
            dark: '#004A43',
            text: 'rgba(255, 255, 255, 0.85)',
            grid: 'rgba(255, 255, 255, 0.1)'
        };

        function wrapLabel(str, maxWidth = 16) {
            if (str.length <= maxWidth) {
                return str;
            }
            const words = str.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + word).length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = '';
                }
                currentLine += word + ' ';
            }
            if (currentLine.trim().length > 0) {
                lines.push(currentLine.trim());
            }
            return lines;
        }

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            return Array.isArray(label) ? label.join(' ') : label;
        };

        const donutChartCtx = document.getElementById('componentDonutChart').getContext('2d');
        new Chart(donutChartCtx, {
            type: 'doughnut',
            data: {
                labels: ['Python Toolchain', 'YAML Data & Schema', 'Test Suite'],
                datasets: [{
                    label: 'System Components',
                    data: [65, 25, 10],
                    backgroundColor: [colorPalette.secondary, colorPalette.primary, colorPalette.tertiary],
                    borderColor: '#1f2937',
                    borderWidth: 4,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            color: colorPalette.text,
                            font: { size: 14 }
                        }
                    },
                    tooltip: {
                         callbacks: { title: tooltipTitleCallback }
                    }
                }
            }
        });

        const barChartCtx = document.getElementById('scriptBarChart').getContext('2d');
        const rawLabels = ['validate.py', 'read_key.py', 'update_key.py', 'add_item.py', 'delete_item.py', 'prune.py', 'merge.py (Interactive Merge)'];
        
        new Chart(barChartCtx, {
            type: 'bar',
            data: {
                labels: rawLabels.map(label => wrapLabel(label)),
                datasets: [{
                    label: 'Conceptual Complexity / Role',
                    data: [3, 2, 6, 5, 5, 7, 9],
                    backgroundColor: [
                        colorPalette.primary, 
                        colorPalette.secondary, 
                        colorPalette.tertiary,
                        '#008c80',
                        colorPalette.dark,
                        '#003833',
                        '#002D29'
                    ],
                    borderColor: colorPalette.secondary,
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        grid: { color: colorPalette.grid },
                        ticks: { color: colorPalette.text },
                        title: { display: true, text: 'Conceptual Complexity', color: colorPalette.text }
                    },
                    y: {
                        grid: { color: 'transparent' },
                        ticks: { color: colorPalette.text, font: {size: 12} }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                         callbacks: { title: tooltipTitleCallback }
                    }
                }
            }
        });

        const generateBtn = document.getElementById('generateBtn');
        const personaInput = document.getElementById('personaInput');
        const loader = document.getElementById('loader');
        const outputContainer = document.getElementById('outputContainer');
        const yamlOutput = document.getElementById('yamlOutput');

        async function generateInstructions() {
            const persona = personaInput.value;
            if (!persona) {
                alert("Please enter a persona for the AI.");
                return;
            }

            generateBtn.disabled = true;
            generateBtn.classList.add('opacity-50');
            loader.classList.remove('hidden');
            outputContainer.classList.add('hidden');

            const prompt = `You are an expert in creating configuration files for AI agents. A user wants to create an AI with the role: '${persona}'. Generate a well-structured YAML configuration file named 'master_instructions.yaml' for this role. The file should include a 'persona' section with a detailed description and a 'rules' section with at least 5 relevant rules. The output must be only the YAML content, without any surrounding text or markdown backticks.`;
            
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    yamlOutput.textContent = text.trim();
                    outputContainer.classList.remove('hidden');
                } else {
                    yamlOutput.textContent = "Error: Could not generate instructions. The API returned an empty response.";
                    outputContainer.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                yamlOutput.textContent = `Error: Could not connect to the API. ${error.message}`;
                outputContainer.classList.remove('hidden');
            } finally {
                loader.classList.add('hidden');
                generateBtn.disabled = false;
                generateBtn.classList.remove('opacity-50');
            }
        }

        function copyToClipboard() {
            const textToCopy = yamlOutput.textContent;
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                alert('Copied to clipboard!');
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            document.body.removeChild(textArea);
        }
        
        const modal = document.getElementById('explanationModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalContent = document.getElementById('modalContent');
        
        async function explainSection(sectionId) {
            const section = document.getElementById(sectionId);
            const title = section.querySelector('h2').innerText.replace('‚ú®','').trim();
            const content = section.innerText;

            modalTitle.innerText = `Explaining: ${title}`;
            modalContent.innerHTML = '<div class="loader mx-auto"></div>';
            modal.classList.remove('hidden');

            const prompt = `You are an AI systems architect. In the context of an infographic about building adaptive AI agents, explain the following section in more detail. Make it clear and conversational for a developer audience. Section Title: "${title}". Section Content: "${content}"`;

            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                 if (result.candidates && result.candidates.length > 0 && result.candidates[0].content.parts.length > 0) {
                    modalContent.innerHTML = result.candidates[0].content.parts[0].text.replace(/\n/g, '<br>');
                } else {
                    modalContent.innerText = "Apologies, I could not generate an explanation at this time.";
                }
            } catch (error) {
                console.error("Explanation error:", error);
                modalContent.innerText = "Error fetching explanation from the API.";
            }
        }
        
        function closeModal() {
            modal.classList.add('hidden');
        }
        
    </script>
</body>
</html>

