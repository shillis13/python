<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Chosen Palette: Energetic & Playful -->
    <!-- Application Structure Plan: The SPA is structured as a top-to-bottom narrative to guide the user through a story. It starts with a Hero section to introduce the topic, followed by 'The Problem' to establish context. 'Core Philosophy' presents the solution's foundational pillars. 'System Architecture' uses data visualizations to break down the components. 'The Workflow in Action' uses a custom CSS flowchart to detail the operational cycle. The 'Interactive Sandbox' allows for hands-on experience. Finally, 'Advanced Capabilities' covers expert features. This structure was chosen over a dashboard layout to create a guided learning experience, making the complex technical protocol easy to digest for a developer audience. -->
    <!-- Visualization & Content Choices: 
        - Problem Section: Goal: Inform. Method: Two side-by-side HTML cards with Unicode icons. Justification: Quickly establishes the core problem without complex charts.
        - Philosophy Section: Goal: Organize. Method: A five-column grid of HTML cards with Unicode icons. Justification: Presents the five principles as equal, foundational pillars.
        - Architecture - Component Distribution: Goal: Compare (Composition). Method: Donut Chart via Chart.js/Canvas. Justification: Best way to show the proportional breakdown of the system's parts. NO SVG.
        - Architecture - Toolchain Responsibilities: Goal: Compare (Ranking). Method: Horizontal Bar Chart via Chart.js/Canvas. Justification: Effectively compares the conceptual complexity of each script in the toolchain. NO SVG.
        - Workflow Section: Goal: Organize (Process). Method: Custom flowchart using styled HTML divs and CSS pseudo-elements. Justification: Provides a clear, step-by-step visual representation of the operational loop. NO SVG/Mermaid.
        - Sandbox Section: Goal: Interact. Method: HTML form elements and a code display area, powered by a JavaScript fetch call to the Gemini API. Justification: Provides a hands-on demonstration of the protocol's output.
        - Advanced Capabilities Section: Goal: Inform. Method: Two side-by-side HTML cards. Justification: Simple, clear presentation for final features.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <title>Interactive Infographic: The Agent Continuity Protocol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #212529;
        }
        .flow-arrow::after {
            content: '‚ñº';
            font-size: 1.5rem;
            color: #FF874F;
            line-height: 1;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .chart-container {
            position: relative;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 45vh;
            width: 100%;
            max-width: 550px;
        }
         @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .sticky-nav {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .loader {
            border: 4px solid #dee2e6;
            border-top: 4px solid #FF874F;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <nav class="sticky top-0 z-50 bg-white/80 shadow-sm sticky-nav">
        <div class="container mx-auto px-4">
            <div class="flex justify-center items-center h-16">
                <div class="flex space-x-4 md:space-x-8 text-sm md:text-base font-semibold">
                    <a href="#problem" class="text-[#212529] hover:text-[#FF874F] transition">The Problem</a>
                    <a href="#solution" class="text-[#212529] hover:text-[#FF874F] transition">The Solution</a>
                    <a href="#architecture" class="text-[#212529] hover:text-[#FF874F] transition">Architecture</a>
                    <a href="#workflow" class="text-[#212529] hover:text-[#FF874F] transition">Workflow</a>
                    <a href="#sandbox" class="text-[#212529] hover:text-[#FF874F] transition">Sandbox</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center my-12 md:my-20">
            <h1 class="text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-[#FF874F] to-[#5C67F2]">The Agent Continuity Protocol</h1>
            <p class="mt-4 text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">A protocol for evolving and persisting core AI instructions across chat sessions.</p>
        </header>

        <main>
            <section id="problem" class="my-16 md:my-24 scroll-mt-20">
                <h2 class="text-3xl font-bold text-center mb-4 flex items-center justify-center">The Challenge: Static AI <button onclick="explainSection('problem')" class="text-2xl ml-3 text-[#FF874F] hover:text-[#5C67F2] transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <p class="text-center text-lg text-gray-600 mb-12 max-w-2xl mx-auto">Standard AI interactions are limited by two fundamental issues that prevent long-term, adaptive collaboration.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <div class="bg-white rounded-lg shadow-xl p-8 border border-gray-200 transform hover:-translate-y-2 transition-transform">
                        <div class="text-5xl mb-4" aria-hidden="true">üß†‚ÜíüóëÔ∏è</div>
                        <h3 class="text-2xl font-bold text-[#5C67F2] mb-2">Stateless Sessions</h3>
                        <p class="text-gray-600">Once a conversation ends, all context, learned nuances, and specific instructions are lost. This forces users to repeat themselves and start from scratch in every new session.</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-xl p-8 border border-gray-200 transform hover:-translate-y-2 transition-transform">
                        <div class="text-5xl mb-4" aria-hidden="true">üìúüö´‚úçÔ∏è</div>
                        <h3 class="text-2xl font-bold text-[#5C67F2] mb-2">Fixed Instructions</h3>
                        <p class="text-gray-600">An AI's core instructions are typically set once. They cannot be modified or improved through interaction, limiting the agent's ability to adapt to a user's evolving needs.</p>
                    </div>
                </div>
            </section>

            <section id="solution" class="my-16 md:my-24 bg-gradient-to-br from-[#5C67F2] to-[#A86ADD] text-white py-16 rounded-2xl scroll-mt-20 shadow-2xl">
                <h2 class="text-3xl font-bold text-center mb-4 flex items-center justify-center">The Solution: A New Protocol <button onclick="explainSection('solution')" class="text-2xl ml-3 text-white hover:text-yellow-300 transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <p class="text-center text-lg text-indigo-100 mb-12 max-w-2xl mx-auto">The Agent Continuity Protocol treats the AI's instructions as a version-controlled configuration file, built on five core principles.</p>
                <div class="grid grid-cols-2 lg:grid-cols-5 gap-6 text-center max-w-6xl mx-auto px-4">
                    <div class="bg-white/20 p-4 rounded-lg "><div class="text-3xl mb-2">ü§ù</div><h3 class="font-bold">Collaborative Evolution</h3></div>
                    <div class="bg-white/20 p-4 rounded-lg "><div class="text-3xl mb-2">‚öôÔ∏è</div><h3 class="font-bold">Programmatic Robustness</h3></div>
                    <div class="bg-white/20 p-4 rounded-lg "><div class="text-3xl mb-2">‚úÖ</div><h3 class="font-bold">Structured & Validated</h3></div>
                    <div class="bg-white/20 p-4 rounded-lg "><div class="text-3xl mb-2">üóÇÔ∏è</div><h3 class="font-bold">Self-Contained History</h3></div>
                    <div class="bg-white/20 p-4 rounded-lg "><div class="text-3xl mb-2">üßë‚Äç‚öñÔ∏è</div><h3 class="font-bold">Human as Final Authority</h3></div>
                </div>
            </section>

            <section id="architecture" class="my-16 md:my-24 scroll-mt-20">
                <h2 class="text-3xl font-bold text-center mb-4 flex items-center justify-center">System Architecture <button onclick="explainSection('architecture')" class="text-2xl ml-3 text-[#FF874F] hover:text-[#5C67F2] transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <p class="text-center text-lg text-gray-600 mb-12 max-w-2xl mx-auto">The protocol is comprised of three main component types, with the Python toolchain doing the heavy lifting.</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-xl font-bold text-center mb-4 text-[#4A4441]">Component Distribution</h3>
                        <div class="chart-container">
                            <canvas id="componentDonutChart"></canvas>
                        </div>
                        <p class="text-center mt-4 text-sm text-gray-600">This chart shows the functional breakdown of the system. The majority of the system's logic and reliability comes from the reusable Python scripts.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-xl font-bold text-center mb-4 text-[#4A4441]">Toolchain Responsibilities</h3>
                        <div class="chart-container">
                            <canvas id="scriptBarChart"></canvas>
                        </div>
                         <p class="text-center mt-4 text-sm text-gray-600">This chart ranks each script by its conceptual role, from simple validation to complex, interactive merging logic.</p>
                    </div>
                </div>
            </section>
            
            <section id="sandbox" class="my-24 bg-white p-8 rounded-lg shadow-2xl border border-gray-200 scroll-mt-20">
                 <h2 class="text-3xl font-bold text-center mb-2 flex items-center justify-center">Interactive Sandbox <button onclick="explainSection('sandbox')" class="text-2xl ml-3 text-[#FF874F] hover:text-[#5C67F2] transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                 <p class="text-center text-gray-600 mb-8">Test the protocol by generating a sample instruction file for any AI persona.</p>
                 <div class="max-w-4xl mx-auto">
                    <div class="flex flex-col sm:flex-row gap-4 mb-6">
                        <input type="text" id="personaInput" placeholder="e.g., 'A helpful sommelier'" class="flex-grow bg-gray-100 border border-gray-300 rounded-md p-3 text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#5C67F2]">
                        <button id="generateBtn" onclick="generateInstructions()" class="bg-gradient-to-r from-[#FF874F] to-[#F25A5A] text-white font-bold py-3 px-6 rounded-md hover:opacity-90 transition-opacity duration-300 flex items-center justify-center space-x-2 shadow-lg">
                            <span>Generate Instructions</span>
                            <span class="text-xl">‚ú®</span>
                        </button>
                    </div>
                    <div id="loader" class="hidden mx-auto my-8 loader"></div>
                    <div id="outputContainer" class="hidden">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-lg font-semibold text-gray-700">Generated `master_instructions.yaml`</h4>
                            <button onclick="copyToClipboard()" class="bg-gray-200 text-sm text-gray-700 py-1 px-3 rounded-md hover:bg-gray-300">Copy</button>
                        </div>
                        <pre class="bg-gray-800 text-white rounded-md p-4 max-h-[400px] overflow-auto"><code id="yamlOutput" class="language-yaml"></code></pre>
                    </div>
                 </div>
            </section>

            <section id="workflow" class="my-16 md:my-24 scroll-mt-20">
                <h2 class="text-3xl font-bold text-center mb-4 flex items-center justify-center">The Workflow in Action <button onclick="explainSection('workflow')" class="text-2xl ml-3 text-[#FF874F] hover:text-[#5C67F2] transition-transform duration-200 hover:scale-125">‚ú®</button></h2>
                <p class="text-center text-lg text-gray-600 mb-12 max-w-3xl mx-auto">The protocol enables a continuous improvement loop, moving from session start to a user-led "commit" of an improved instruction set.</p>
                <div class="flex flex-col items-center space-y-0">
                    <div class="bg-white border-2 border-gray-200 rounded-lg p-6 w-full max-w-2xl shadow-sm text-center">
                        <div class="text-xs font-bold uppercase text-gray-500">Step 1: AI Action</div>
                        <h4 class="text-xl font-bold mt-1 text-[#5C67F2]">Session Start</h4>
                        <p class="mt-2">AI reads `master_instructions.yaml` and creates an editable, in-session copy.</p>
                    </div>
                    <div class="flow-arrow" aria-hidden="true"></div>
                    <div class="bg-white border-2 border-dashed border-gray-400 rounded-lg p-6 w-full max-w-2xl shadow-sm text-center">
                        <div class="text-xs font-bold uppercase text-gray-500">Step 2-3: Collaborative Update</div>
                        <h4 class="text-xl font-bold mt-1 text-[#5C67F2]">User & AI Interaction</h4>
                        <p class="mt-2">After discussion, the AI is instructed to modify the session copy using a toolchain script (e.g., `update_key.py`).</p>
                    </div>
                    <div class="flow-arrow" aria-hidden="true"></div>
                     <div class="bg-white border-2 border-gray-200 rounded-lg p-6 w-full max-w-2xl shadow-sm text-center">
                        <div class="text-xs font-bold uppercase text-gray-500">Step 4: User Request</div>
                        <h4 class="text-xl font-bold mt-1 text-[#5C67F2]">Session Conclusion</h4>
                        <p class="mt-2">User asks the AI to prepare the finalized instructions for saving.</p>
                    </div>
                     <div class="flow-arrow" aria-hidden="true"></div>
                    <div class="bg-white border-2 border-gray-200 rounded-lg p-6 w-full max-w-2xl shadow-sm text-center">
                        <div class="text-xs font-bold uppercase text-gray-500">Step 5: AI Action</div>
                        <h4 class="text-xl font-bold mt-1 text-[#5C67F2]">Export Instructions</h4>
                        <p class="mt-2">AI presents the final YAML content in a clean, copyable code block.</p>
                    </div>
                     <div class="flow-arrow" aria-hidden="true"></div>
                    <div class="bg-[#212529] text-white rounded-lg p-6 w-full max-w-2xl shadow-lg text-center">
                        <div class="text-xs font-bold uppercase text-gray-400">Step 6: User "Commit"</div>
                        <h4 class="text-xl font-bold mt-1 text-white">Save New Master</h4>
                        <p class="text-gray-300 mt-2">User saves the exported content as the new `master_instructions.yaml`, making it the source of truth for the next session.</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-16 md:mt-24 pb-8">
            <p class="text-sm text-gray-500">This interactive infographic was generated based on the "agent-continuity-protocol" summary.</p>
        </footer>

    </div>
    
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b border-gray-200">
                <h3 id="modalTitle" class="text-xl font-bold text-[#5C67F2]">Explanation</h3>
                <button onclick="closeModal()" class="text-2xl text-gray-500 hover:text-black">&times;</button>
            </div>
            <div id="modalContent" class="p-6 overflow-y-auto">
                <div class="loader mx-auto"></div>
            </div>
        </div>
    </div>


    <script>
        const colorPalette = {
            primary: '#FF874F',
            secondary: '#5C67F2',
            tertiary: '#A86ADD',
            text: '#212529',
            background: '#F8F9FA',
            grid: 'rgba(33, 37, 41, 0.1)',
        };

        function wrapLabel(str, maxWidth = 16) {
            if (str.length <= maxWidth) { return str; }
            const words = str.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                const testLine = currentLine + word + ' ';
                if (testLine.length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = word + ' ';
                } else {
                    currentLine = testLine;
                }
            }
            if (currentLine.trim().length > 0) { lines.push(currentLine.trim()); }
            return lines;
        }
        
        const tooltipTitleCallback = function(tooltipItems) {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            return Array.isArray(label) ? label.join(' ') : label;
        };
        
        const defaultChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        color: colorPalette.text,
                        font: { size: 14, family: 'Inter, sans-serif' }
                    }
                },
                tooltip: {
                    callbacks: { title: tooltipTitleCallback },
                    bodyFont: { family: 'Inter, sans-serif' },
                    titleFont: { family: 'Inter, sans-serif' }
                }
            }
        };

        const donutChartCtx = document.getElementById('componentDonutChart').getContext('2d');
        new Chart(donutChartCtx, {
            type: 'doughnut',
            data: {
                labels: ['Python Toolchain', 'YAML Data & Schema', 'Test Suite'],
                datasets: [{
                    label: '% of System',
                    data: [60, 30, 10],
                    backgroundColor: [colorPalette.secondary, colorPalette.primary, colorPalette.tertiary],
                    borderColor: '#ffffff',
                    borderWidth: 4,
                    hoverOffset: 8
                }]
            },
            options: { ...defaultChartOptions, plugins: { ...defaultChartOptions.plugins, legend: { ...defaultChartOptions.plugins.legend, position: 'bottom' }}}
        });

        const barChartCtx = document.getElementById('scriptBarChart').getContext('2d');
        const rawLabels = ['read_key.py', 'validate.py', 'add_item.py', 'delete_item.py', 'update_key.py', 'prune.py', 'merge.py'];
        
        new Chart(barChartCtx, {
            type: 'bar',
            data: {
                labels: rawLabels.map(label => wrapLabel(label, 20)),
                datasets: [{
                    label: 'Conceptual Complexity Score',
                    data: [2, 3, 5, 5, 6, 7, 9],
                    backgroundColor: ['#A86ADD', '#955de2', '#8252da', '#6f48d2', '#5C67F2', '#535de0', '#4a53ce'],
                    borderRadius: 4
                }]
            },
            options: {
                ...defaultChartOptions,
                indexAxis: 'y',
                scales: {
                    x: { grid: { color: colorPalette.grid }, ticks: { color: colorPalette.text, font: {family: 'Inter, sans-serif'} } },
                    y: { grid: { drawOnChartArea: false }, ticks: { color: colorPalette.text, font: {size: 12, family: 'Inter, sans-serif'} } }
                },
                plugins: { ...defaultChartOptions.plugins, legend: { display: false } }
            }
        });
        
        const generateBtn = document.getElementById('generateBtn');
        const personaInput = document.getElementById('personaInput');
        const loader = document.getElementById('loader');
        const outputContainer = document.getElementById('outputContainer');
        const yamlOutput = document.getElementById('yamlOutput');

        async function generateInstructions() {
            const persona = personaInput.value;
            if (!persona) { alert("Please enter a persona for the AI."); return; }
            generateBtn.disabled = true;
            generateBtn.classList.add('opacity-50');
            loader.classList.remove('hidden');
            outputContainer.classList.add('hidden');
            const prompt = `You are an expert in creating configuration files for AI agents. A user wants to create an AI with the role: '${persona}'. Generate a well-structured YAML configuration file named 'master_instructions.yaml' for this role. The file should include a 'persona' section with a detailed description and a 'rules' section with at least 5 relevant rules. The output must be only the YAML content, without any surrounding text or markdown backticks.`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                const result = await response.json();
                if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts) {
                    const text = result.candidates[0].content.parts[0].text;
                    yamlOutput.textContent = text.trim();
                } else {
                    yamlOutput.textContent = "Error: Could not generate instructions. The API returned an empty or invalid response.";
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                yamlOutput.textContent = `Error: Could not connect to the API. ${error.message}`;
            } finally {
                outputContainer.classList.remove('hidden');
                loader.classList.add('hidden');
                generateBtn.disabled = false;
                generateBtn.classList.remove('opacity-50');
            }
        }

        function copyToClipboard() {
            const textToCopy = yamlOutput.textContent;
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                alert('Copied to clipboard!');
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            document.body.removeChild(textArea);
        }
        
        const modal = document.getElementById('explanationModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalContent = document.getElementById('modalContent');
        
        async function explainSection(sectionId) {
            const section = document.getElementById(sectionId);
            const title = section.querySelector('h2').innerText.replace('‚ú®','').trim();
            modalTitle.innerText = `Explaining: ${title}`;
            modalContent.innerHTML = '<div class="loader mx-auto"></div>';
            modal.classList.remove('hidden');
            const prompt = `In the context of an infographic about the "Agent Continuity Protocol", explain the section titled "${title}" in a clear and conversational way for a developer audience. Focus on its purpose and importance within the protocol.`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                const result = await response.json();
                 if (result.candidates && result.candidates[0].content.parts) {
                    modalContent.innerHTML = result.candidates[0].content.parts[0].text.replace(/\n/g, '<br>');
                } else {
                    modalContent.innerText = "Apologies, I could not generate an explanation at this time.";
                }
            } catch (error) {
                console.error("Explanation error:", error);
                modalContent.innerText = "Error fetching explanation from the API.";
            }
        }
        
        function closeModal() {
            modal.classList.add('hidden');
        }
    </script>
</body>
</html>

